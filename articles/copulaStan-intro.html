<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with copulaStan • copulaStan</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting Started with copulaStan">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">copulaStan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/copulaStan-intro.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/benlug/copulaStan" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with copulaStan</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/benlug/copulaStan/blob/main/vignettes/copulaStan-intro.Rmd" class="external-link"><code>vignettes/copulaStan-intro.Rmd</code></a></small>
      <div class="d-none name"><code>copulaStan-intro.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When modeling multivariate data, we often need to capture the
dependence between variables while allowing each variable to follow its
own distribution. For example, insurance claim amounts might be
lognormally distributed while waiting times are exponential, yet the two
are clearly not independent.</p>
<p><strong>Copulas</strong> solve this by separating the modeling of
marginal distributions from the modeling of dependence. A copula links
univariate marginal distributions into a joint multivariate
distribution, so you can choose the best-fitting distribution for each
variable independently and then choose a copula to describe how the
variables relate.</p>
<p><code>copulaStan</code> fits bivariate copula models using Stan for
full Bayesian inference. It jointly estimates all parameters – both the
marginal distribution parameters and the copula dependence parameter –
and returns posterior distributions for uncertainty quantification.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://benlug.github.io/copulaStan/">copulaStan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://copula.r-forge.r-project.org/" class="external-link">copula</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="choosing-a-copula">Choosing a Copula<a class="anchor" aria-label="anchor" href="#choosing-a-copula"></a>
</h2>
<p>The package supports three copula families, each suited to different
dependence patterns:</p>
<div class="section level3">
<h3 id="gaussian-copula">Gaussian Copula<a class="anchor" aria-label="anchor" href="#gaussian-copula"></a>
</h3>
<p>Use <code>copula = "gaussian"</code> for symmetric dependence without
tail dependence. Variables are correlated, but extreme events in one
variable do not make extreme events in the other more likely. The
dependence parameter <code>rho</code> ranges from -1 to 1, analogous to
a correlation coefficient.</p>
</div>
<div class="section level3">
<h3 id="clayton-copula">Clayton Copula<a class="anchor" aria-label="anchor" href="#clayton-copula"></a>
</h3>
<p>Use <code>copula = "clayton"</code> for <strong>lower tail
dependence</strong> – the tendency for small values to cluster together
more strongly than large values. Useful for phenomena like joint
defaults in credit risk or co-occurring low returns in finance. The
dependence parameter <code>theta</code> is positive; larger values
indicate stronger lower-tail dependence.</p>
</div>
<div class="section level3">
<h3 id="joe-copula">Joe Copula<a class="anchor" aria-label="anchor" href="#joe-copula"></a>
</h3>
<p>Use <code>copula = "joe"</code> for <strong>upper tail
dependence</strong> – the tendency for large values to co-occur. Useful
when extreme high values in one variable make extreme high values in the
other more likely, such as joint insurance claims during catastrophic
events. The dependence parameter <code>theta</code> is at least 1;
larger values indicate stronger upper-tail dependence.</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="gaussian-copula-with-normal-lognormal-marginals">Gaussian Copula with Normal + Lognormal Marginals<a class="anchor" aria-label="anchor" href="#gaussian-copula-with-normal-lognormal-marginals"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">2024</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">true_rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span></span>
<span><span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.8</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/ellipCopula.html" class="external-link">normalCopula</a></span><span class="op">(</span>param <span class="op">=</span> <span class="va">true_rho</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mvdc_copula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">mvdc</a></span><span class="op">(</span><span class="va">cop</span>, margins <span class="op">=</span> <span class="va">margins</span>, paramMargins <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">rMvdc</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mvdc_copula</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_bivariate_copula.html">fit_bivariate_copula</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  copula <span class="op">=</span> <span class="st">"gaussian"</span>, marginals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"lognormal"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Bivariate Copula Fit --------------------------------------------------------</span></span>
<span><span class="co">#&gt; Copula: gaussian</span></span>
<span><span class="co">#&gt; Marginals: "normal", "lognormal"</span></span>
<span><span class="co">#&gt; Data: 2000 observations</span></span>
<span><span class="co">#&gt; ----</span></span>
<span><span class="co">#&gt;   variable      mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt; 1 mu1[1]       0.840   0.840  0.044  0.044   0.768 0.912 1.00     4200     3100</span></span>
<span><span class="co">#&gt; 2 sigma1[1]    1.982   1.982  0.032  0.032   1.930 2.034 1.00     4100     3000</span></span>
<span><span class="co">#&gt; 3 mu2[1]       0.003   0.003  0.018  0.018  -0.027 0.032 1.00     3900     2900</span></span>
<span><span class="co">#&gt; 4 sigma2[1]    0.796   0.796  0.013  0.013   0.775 0.817 1.00     4000     3100</span></span>
<span><span class="co">#&gt; 5 rho[1]       0.501   0.501  0.017  0.017   0.473 0.529 1.00     4100     3200</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 x 10</span></span>
<span><span class="co">#&gt;   variable      mean  median     sd    mad      q5   q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 mu1[1]       0.840   0.840  0.044  0.044   0.768 0.912  1.00     4200     3100</span></span>
<span><span class="co">#&gt; 2 sigma1[1]    1.982   1.982  0.032  0.032   1.930 2.034  1.00     4100     3000</span></span>
<span><span class="co">#&gt; 3 mu2[1]       0.003   0.003  0.018  0.018  -0.027 0.032  1.00     3900     2900</span></span>
<span><span class="co">#&gt; 4 sigma2[1]    0.796   0.796  0.013  0.013   0.775 0.817  1.00     4000     3100</span></span>
<span><span class="co">#&gt; 5 rho[1]       0.501   0.501  0.017  0.017   0.473 0.529  1.00     4100     3200</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;     mu1[1]  sigma1[1]     mu2[1]  sigma2[1]     rho[1]</span></span>
<span><span class="co">#&gt;      0.840      1.982      0.003      0.796      0.501</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gaussian-copula-with-normal-exponential-marginals">Gaussian Copula with Normal + Exponential Marginals<a class="anchor" aria-label="anchor" href="#gaussian-copula-with-normal-exponential-marginals"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">2024</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">true_rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span></span>
<span><span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"exp"</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.8</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/ellipCopula.html" class="external-link">normalCopula</a></span><span class="op">(</span>param <span class="op">=</span> <span class="va">true_rho</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mvdc_copula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">mvdc</a></span><span class="op">(</span><span class="va">cop</span>, margins <span class="op">=</span> <span class="va">margins</span>, paramMargins <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">rMvdc</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mvdc_copula</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_bivariate_copula.html">fit_bivariate_copula</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  copula <span class="op">=</span> <span class="st">"gaussian"</span>, marginals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"exponential"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Bivariate Copula Fit --------------------------------------------------------</span></span>
<span><span class="co">#&gt; Copula: gaussian</span></span>
<span><span class="co">#&gt; Marginals: "normal", "exponential"</span></span>
<span><span class="co">#&gt; Data: 2000 observations</span></span>
<span><span class="co">#&gt; ----</span></span>
<span><span class="co">#&gt;   variable      mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt; 1 mu1[1]       0.818   0.818  0.045  0.045   0.745 0.892 1.00     4000     3000</span></span>
<span><span class="co">#&gt; 2 sigma1[1]    1.987   1.987  0.031  0.031   1.936 2.038 1.00     4100     3000</span></span>
<span><span class="co">#&gt; 3 lambda2[1]   1.004   1.003  0.023  0.023   0.966 1.042 1.00     3900     2800</span></span>
<span><span class="co">#&gt; 4 rho[1]       0.497   0.497  0.018  0.018   0.468 0.527 1.00     4000     3100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;     mu1[1]  sigma1[1] lambda2[1]     rho[1]</span></span>
<span><span class="co">#&gt;      0.818      1.987      1.004      0.497</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gaussian-copula-with-beta-beta-marginals">Gaussian Copula with Beta + Beta Marginals<a class="anchor" aria-label="anchor" href="#gaussian-copula-with-beta-beta-marginals"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">2024</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">true_rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span></span>
<span><span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"beta"</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">3</span>, shape2 <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/ellipCopula.html" class="external-link">normalCopula</a></span><span class="op">(</span>param <span class="op">=</span> <span class="va">true_rho</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mvdc_copula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">mvdc</a></span><span class="op">(</span><span class="va">cop</span>, margins <span class="op">=</span> <span class="va">margins</span>, paramMargins <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">rMvdc</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mvdc_copula</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_bivariate_copula.html">fit_bivariate_copula</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  copula <span class="op">=</span> <span class="st">"gaussian"</span>, marginals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Bivariate Copula Fit --------------------------------------------------------</span></span>
<span><span class="co">#&gt; Copula: gaussian</span></span>
<span><span class="co">#&gt; Marginals: "beta", "beta"</span></span>
<span><span class="co">#&gt; Data: 2000 observations</span></span>
<span><span class="co">#&gt; ----</span></span>
<span><span class="co">#&gt;   variable      mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt; 1 alpha1[1]    2.030   2.026  0.095  0.094   1.877 2.189 1.00     3800     2900</span></span>
<span><span class="co">#&gt; 2 beta1[1]     5.065   5.054  0.260  0.258   4.643 5.500 1.00     3700     2800</span></span>
<span><span class="co">#&gt; 3 alpha2[1]    3.018   3.014  0.138  0.137   2.794 3.245 1.00     3900     3000</span></span>
<span><span class="co">#&gt; 4 beta2[1]     4.025   4.019  0.183  0.182   3.726 4.330 1.00     3800     2900</span></span>
<span><span class="co">#&gt; 5 rho[1]       0.498   0.498  0.018  0.018   0.469 0.528 1.00     4000     3100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;  alpha1[1]   beta1[1]  alpha2[1]   beta2[1]     rho[1]</span></span>
<span><span class="co">#&gt;      2.030      5.065      3.018      4.025      0.498</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clayton-copula-with-normal-lognormal-marginals">Clayton Copula with Normal + Lognormal Marginals<a class="anchor" aria-label="anchor" href="#clayton-copula-with-normal-lognormal-marginals"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">2024</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">true_theta</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span></span>
<span><span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.8</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/archmCopula.html" class="external-link">claytonCopula</a></span><span class="op">(</span>param <span class="op">=</span> <span class="va">true_theta</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mvdc_copula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">mvdc</a></span><span class="op">(</span><span class="va">cop</span>, margins <span class="op">=</span> <span class="va">margins</span>, paramMargins <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">rMvdc</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mvdc_copula</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_bivariate_copula.html">fit_bivariate_copula</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  copula <span class="op">=</span> <span class="st">"clayton"</span>, marginals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"lognormal"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Bivariate Copula Fit --------------------------------------------------------</span></span>
<span><span class="co">#&gt; Copula: clayton</span></span>
<span><span class="co">#&gt; Marginals: "normal", "lognormal"</span></span>
<span><span class="co">#&gt; Data: 2000 observations</span></span>
<span><span class="co">#&gt; ----</span></span>
<span><span class="co">#&gt;   variable              mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt; 1 mu1[1]               0.798   0.798  0.044  0.044   0.726 0.870 1.00     3500     2600</span></span>
<span><span class="co">#&gt; 2 sigma1[1]            1.986   1.986  0.032  0.032   1.934 2.039 1.00     3400     2500</span></span>
<span><span class="co">#&gt; 3 mu2[1]               0.005   0.005  0.019  0.019  -0.025 0.036 1.00     3300     2500</span></span>
<span><span class="co">#&gt; 4 sigma2[1]            0.799   0.798  0.013  0.013   0.777 0.820 1.00     3400     2600</span></span>
<span><span class="co">#&gt; 5 theta_clayton[1]     2.015   2.010  0.105  0.104   1.847 2.192 1.00     3600     2700</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;          mu1[1]       sigma1[1]          mu2[1]       sigma2[1] theta_clayton[1]</span></span>
<span><span class="co">#&gt;           0.798           1.986           0.005           0.799            2.015</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="joe-copula-with-normal-lognormal-marginals">Joe Copula with Normal + Lognormal Marginals<a class="anchor" aria-label="anchor" href="#joe-copula-with-normal-lognormal-marginals"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">2024</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">true_theta</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span></span>
<span><span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"lnorm"</span><span class="op">)</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.8</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/archmCopula.html" class="external-link">joeCopula</a></span><span class="op">(</span>param <span class="op">=</span> <span class="va">true_theta</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mvdc_copula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">mvdc</a></span><span class="op">(</span><span class="va">cop</span>, margins <span class="op">=</span> <span class="va">margins</span>, paramMargins <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">rMvdc</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mvdc_copula</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_bivariate_copula.html">fit_bivariate_copula</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  copula <span class="op">=</span> <span class="st">"joe"</span>, marginals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"lognormal"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Bivariate Copula Fit --------------------------------------------------------</span></span>
<span><span class="co">#&gt; Copula: joe</span></span>
<span><span class="co">#&gt; Marginals: "normal", "lognormal"</span></span>
<span><span class="co">#&gt; Data: 2000 observations</span></span>
<span><span class="co">#&gt; ----</span></span>
<span><span class="co">#&gt;   variable          mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt; 1 mu1[1]           0.810   0.810  0.044  0.044   0.738 0.882 1.00     3400     2500</span></span>
<span><span class="co">#&gt; 2 sigma1[1]        1.994   1.994  0.032  0.032   1.942 2.047 1.00     3500     2600</span></span>
<span><span class="co">#&gt; 3 mu2[1]          -0.002  -0.002  0.019  0.019  -0.033 0.028 1.00     3300     2500</span></span>
<span><span class="co">#&gt; 4 sigma2[1]        0.803   0.803  0.013  0.013   0.781 0.825 1.00     3400     2600</span></span>
<span><span class="co">#&gt; 5 theta_joe[1]     2.008   2.005  0.080  0.079   1.878 2.142 1.00     3600     2700</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;      mu1[1]   sigma1[1]      mu2[1]   sigma2[1] theta_joe[1]</span></span>
<span><span class="co">#&gt;       0.810       1.994      -0.002       0.803        2.008</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model-diagnostics">Model Diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h2>
<p>After fitting a model, check these diagnostics to ensure reliable
results.</p>
<div class="section level3">
<h3 id="convergence-rhat-and-effective-sample-size">Convergence: Rhat and Effective Sample Size<a class="anchor" aria-label="anchor" href="#convergence-rhat-and-effective-sample-size"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> output includes <code>rhat</code>,
<code>ess_bulk</code>, and <code>ess_tail</code> for each parameter,
computed by the <code>posterior</code> package.</p>
<ul>
<li>
<strong>Rhat</strong> should be below 1.01 for all parameters.
Values above 1.01 suggest the chains have not converged.</li>
<li>
<strong>ess_bulk</strong> and <strong>ess_tail</strong> report the
effective sample size for bulk and tail quantities of the posterior. Aim
for at least 400 effective samples per parameter.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check convergence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">summ</span><span class="op">$</span><span class="va">rhat</span> <span class="op">&lt;</span> <span class="fl">1.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check effective sample sizes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">summ</span><span class="op">$</span><span class="va">ess_bulk</span> <span class="op">&gt;</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="divergent-transitions">Divergent Transitions<a class="anchor" aria-label="anchor" href="#divergent-transitions"></a>
</h3>
<p>CmdStan reports divergent transitions after sampling. If you see
divergences, increase <code>adapt_delta</code> from the default of 0.8
toward 1:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_bivariate_copula.html">fit_bivariate_copula</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>  copula <span class="op">=</span> <span class="st">"gaussian"</span>, marginals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"lognormal"</span><span class="op">)</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If divergences persist at <code>adapt_delta = 0.99</code>, this may
indicate a model-data mismatch (for example, using a Clayton copula for
data with upper tail dependence).</p>
</div>
<div class="section level3">
<h3 id="model-comparison-with-loo-cv">Model Comparison with LOO-CV<a class="anchor" aria-label="anchor" href="#model-comparison-with-loo-cv"></a>
</h3>
<p>The model stores pointwise log-likelihoods (<code>log_lik</code>) in
the generated quantities block. Use these with the <code>loo</code>
package for approximate leave-one-out cross-validation:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/loo/" class="external-link">loo</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract log-likelihood matrix: rows = iterations, columns = observations</span></span>
<span><span class="va">log_lik</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="st">"log_lik"</span>, format <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span>
<span><span class="va">loo_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="va">log_lik</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">loo_result</span><span class="op">)</span></span></code></pre></div>
<p>To compare two models, fit each and compare their <code>loo</code>
objects:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_gaussian</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="va">fit_gaussian</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="st">"log_lik"</span>, format <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loo_clayton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="va">fit_clayton</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="st">"log_lik"</span>, format <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="va">loo_gaussian</span>, <span class="va">loo_clayton</span><span class="op">)</span></span></code></pre></div>
<p>The model with the higher expected log predictive density (ELPD) is
preferred.</p>
</div>
</div>
<div class="section level2">
<h2 id="prior-specification">Prior Specification<a class="anchor" aria-label="anchor" href="#prior-specification"></a>
</h2>
<p>The Stan model uses weakly informative default priors designed to
regularize estimation without strongly constraining the posterior.</p>
<div class="section level3">
<h3 id="marginal-distribution-priors">Marginal Distribution Priors<a class="anchor" aria-label="anchor" href="#marginal-distribution-priors"></a>
</h3>
<table class="table">
<colgroup>
<col width="17%">
<col width="13%">
<col width="22%">
<col width="45%">
</colgroup>
<thead><tr class="header">
<th align="left">Distribution</th>
<th align="left">Parameter</th>
<th align="left">Prior</th>
<th align="left">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Normal</td>
<td align="left"><code>mu</code></td>
<td align="left">Normal(0, 5)</td>
<td align="left">Weakly informative location prior</td>
</tr>
<tr class="even">
<td align="left">Normal</td>
<td align="left"><code>sigma</code></td>
<td align="left">Lognormal(0, 1)</td>
<td align="left">Positive-constrained; median = 1</td>
</tr>
<tr class="odd">
<td align="left">Lognormal</td>
<td align="left"><code>mu</code></td>
<td align="left">Normal(0, 5)</td>
<td align="left">Weakly informative location prior</td>
</tr>
<tr class="even">
<td align="left">Lognormal</td>
<td align="left"><code>sigma</code></td>
<td align="left">Lognormal(0, 1)</td>
<td align="left">Positive-constrained; median = 1</td>
</tr>
<tr class="odd">
<td align="left">Exponential</td>
<td align="left"><code>lambda</code></td>
<td align="left">Lognormal(0, 1)</td>
<td align="left">Positive-constrained; median = 1</td>
</tr>
<tr class="even">
<td align="left">Beta</td>
<td align="left"><code>alpha</code></td>
<td align="left">Gamma(2, 0.5)</td>
<td align="left">Positive; mean = 4</td>
</tr>
<tr class="odd">
<td align="left">Beta</td>
<td align="left"><code>beta</code></td>
<td align="left">Gamma(2, 0.5)</td>
<td align="left">Positive; mean = 4</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="copula-dependence-parameter-priors">Copula Dependence Parameter Priors<a class="anchor" aria-label="anchor" href="#copula-dependence-parameter-priors"></a>
</h3>
<table class="table">
<colgroup>
<col width="11%">
<col width="20%">
<col width="28%">
<col width="40%">
</colgroup>
<thead><tr class="header">
<th align="left">Copula</th>
<th align="left">Parameter</th>
<th align="left">Prior</th>
<th align="left">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gaussian</td>
<td align="left"><code>rho</code></td>
<td align="left">Uniform(-1, 1)</td>
<td align="left">Flat prior on the correlation</td>
</tr>
<tr class="even">
<td align="left">Clayton</td>
<td align="left"><code>theta_clayton</code></td>
<td align="left">Lognormal(0, 1)</td>
<td align="left">Positive-constrained; median = 1</td>
</tr>
<tr class="odd">
<td align="left">Joe</td>
<td align="left"><code>theta_joe</code></td>
<td align="left">Lognormal(log(2), 0.5)</td>
<td align="left">Lower-bounded at 1; median = 2</td>
</tr>
</tbody>
</table>
<p>Custom priors are not currently supported through the R interface. To
use different priors, modify the Stan model file directly at
<code>inst/stan/fit_bivariate_copula.stan</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="mathematical-details">Mathematical Details<a class="anchor" aria-label="anchor" href="#mathematical-details"></a>
</h2>
<div class="section level3">
<h3 id="gaussian-copula-1">Gaussian Copula<a class="anchor" aria-label="anchor" href="#gaussian-copula-1"></a>
</h3>
<p><strong>Transformation to uniform marginals:</strong> <span class="math display">\[U_1 = F_1(X_1), \quad U_2 = F_2(X_2)\]</span></p>
<p>where <span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_2\)</span> are the marginal CDFs.</p>
<p><strong>Transformation to standard normal:</strong> <span class="math display">\[Z_1 = \Phi^{-1}(U_1), \quad Z_2 =
\Phi^{-1}(U_2)\]</span></p>
<p><strong>Copula density</strong> (ratio of bivariate to product of
univariate normals): <span class="math display">\[c(u_1, u_2; \rho) =
\frac{1}{\sqrt{1-\rho^2}} \exp\left( -\frac{1}{2(1-\rho^2)}(z_1^2 +
z_2^2 - 2\rho z_1 z_2) + \frac{z_1^2}{2} + \frac{z_2^2}{2}
\right)\]</span></p>
<p><strong>Log-likelihood:</strong> <span class="math display">\[\log
c(u_1, u_2; \rho) = -\frac{1}{2} \log(1-\rho^2) + \frac{\rho z_1 z_2 -
\frac{1}{2}\rho^2 (z_1^2 + z_2^2)}{1-\rho^2}\]</span></p>
</div>
<div class="section level3">
<h3 id="clayton-copula-1">Clayton Copula<a class="anchor" aria-label="anchor" href="#clayton-copula-1"></a>
</h3>
<p><strong>CDF:</strong> <span class="math display">\[C(u, v; \theta) =
\left(u^{-\theta} + v^{-\theta} - 1\right)^{-1/\theta}, \quad \theta
&gt; 0\]</span></p>
<p><strong>Density</strong> (second mixed partial derivative): <span class="math display">\[c(u, v; \theta) = (\theta + 1) \, u^{-\theta - 1}
\, v^{-\theta - 1} \left( u^{-\theta} + v^{-\theta} - 1
\right)^{-1/\theta - 2}\]</span></p>
<p><strong>Log-likelihood:</strong> <span class="math display">\[\log
c(u, v; \theta) = \log(1 + \theta) + (-\theta - 1)(\log u + \log v) -
\frac{2\theta + 1}{\theta} \log(u^{-\theta} + v^{-\theta} -
1)\]</span></p>
</div>
<div class="section level3">
<h3 id="joe-copula-1">Joe Copula<a class="anchor" aria-label="anchor" href="#joe-copula-1"></a>
</h3>
<p><strong>CDF</strong> where <span class="math inline">\(\bar{u} =
1-u\)</span>, <span class="math inline">\(\bar{v} = 1-v\)</span>: <span class="math display">\[C(u, v; \theta) = 1 - \left[\bar{u}^\theta +
\bar{v}^\theta - \bar{u}^\theta \bar{v}^\theta\right]^{1/\theta}, \quad
\theta \geq 1\]</span></p>
<p>Let <span class="math inline">\(a = \bar{u}^\theta\)</span>, <span class="math inline">\(b = \bar{v}^\theta\)</span>, <span class="math inline">\(S = a + b - ab\)</span>.</p>
<p><strong>Density:</strong> <span class="math display">\[c(u, v;
\theta) = \theta \, \bar{u}^{\theta-1} \, \bar{v}^{\theta-1} \,
S^{1/\theta - 2} \left[ S + \frac{\theta - 1}{\theta}(1 - a)(1 - b)
\right]\]</span></p>
<p><strong>Log-likelihood:</strong> <span class="math display">\[\log
c(u, v; \theta) = \log\theta + (\theta-1)[\log\bar{u} + \log\bar{v}] +
\left(\frac{1}{\theta} - 2\right)\log S + \log\left[S +
\frac{\theta-1}{\theta}(1-a)(1-b)\right]\]</span></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benedikt Lugauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
