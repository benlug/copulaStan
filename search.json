[{"path":"https://benlug.github.io/copulaStan/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 copulaStan authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with copulaStan","text":"modeling multivariate data, often need capture dependence variables allowing variable follow distribution. example, insurance claim amounts might lognormally distributed waiting times exponential, yet two clearly independent. Copulas solve separating modeling marginal distributions modeling dependence. copula links univariate marginal distributions joint multivariate distribution, can choose best-fitting distribution variable independently choose copula describe variables relate. copulaStan fits bivariate copula models using Stan full Bayesian inference. jointly estimates parameters – marginal distribution parameters copula dependence parameter – returns posterior distributions uncertainty quantification.","code":"library(copulaStan) library(copula)"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"choosing-a-copula","dir":"Articles","previous_headings":"","what":"Choosing a Copula","title":"Getting Started with copulaStan","text":"package supports three copula families, suited different dependence patterns:","code":""},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"gaussian-copula","dir":"Articles","previous_headings":"Choosing a Copula","what":"Gaussian Copula","title":"Getting Started with copulaStan","text":"Use copula = \"gaussian\" symmetric dependence without tail dependence. Variables correlated, extreme events one variable make extreme events likely. dependence parameter rho ranges -1 1, analogous correlation coefficient.","code":""},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"clayton-copula","dir":"Articles","previous_headings":"Choosing a Copula","what":"Clayton Copula","title":"Getting Started with copulaStan","text":"Use copula = \"clayton\" lower tail dependence – tendency small values cluster together strongly large values. Useful phenomena like joint defaults credit risk co-occurring low returns finance. dependence parameter theta positive; larger values indicate stronger lower-tail dependence.","code":""},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"joe-copula","dir":"Articles","previous_headings":"Choosing a Copula","what":"Joe Copula","title":"Getting Started with copulaStan","text":"Use copula = \"joe\" upper tail dependence – tendency large values co-occur. Useful extreme high values one variable make extreme high values likely, joint insurance claims catastrophic events. dependence parameter theta least 1; larger values indicate stronger upper-tail dependence.","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"gaussian-copula-with-normal-lognormal-marginals","dir":"Articles","previous_headings":"Examples","what":"Gaussian Copula with Normal + Lognormal Marginals","title":"Getting Started with copulaStan","text":"","code":"seed <- 2024 set.seed(seed) true_rho <- 0.5 n <- 2000  margins <- c(\"norm\", \"lnorm\") params <- list(list(mean = 0.8, sd = 2), list(meanlog = 0, sdlog = 0.8)) cop <- normalCopula(param = true_rho, dim = 2) mvdc_copula <- mvdc(cop, margins = margins, paramMargins = params) data <- rMvdc(n, mvdc_copula)  fit <- fit_bivariate_copula(data,   copula = \"gaussian\", marginals = c(\"normal\", \"lognormal\"),   seed = seed )  print(fit) #> -- Bivariate Copula Fit -------------------------------------------------------- #> Copula: gaussian #> Marginals: \"normal\", \"lognormal\" #> Data: 2000 observations #> ---- #>   variable      mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail #> 1 mu1[1]       0.840   0.840  0.044  0.044   0.768 0.912 1.00     4200     3100 #> 2 sigma1[1]    1.982   1.982  0.032  0.032   1.930 2.034 1.00     4100     3000 #> 3 mu2[1]       0.003   0.003  0.018  0.018  -0.027 0.032 1.00     3900     2900 #> 4 sigma2[1]    0.796   0.796  0.013  0.013   0.775 0.817 1.00     4000     3100 #> 5 rho[1]       0.501   0.501  0.017  0.017   0.473 0.529 1.00     4100     3200  summary(fit) #> # A tibble: 5 x 10 #>   variable      mean  median     sd    mad      q5   q95  rhat ess_bulk ess_tail #>   <chr>        <dbl>   <dbl>  <dbl>  <dbl>   <dbl> <dbl> <dbl>    <dbl>    <dbl> #> 1 mu1[1]       0.840   0.840  0.044  0.044   0.768 0.912  1.00     4200     3100 #> 2 sigma1[1]    1.982   1.982  0.032  0.032   1.930 2.034  1.00     4100     3000 #> 3 mu2[1]       0.003   0.003  0.018  0.018  -0.027 0.032  1.00     3900     2900 #> 4 sigma2[1]    0.796   0.796  0.013  0.013   0.775 0.817  1.00     4000     3100 #> 5 rho[1]       0.501   0.501  0.017  0.017   0.473 0.529  1.00     4100     3200  coef(fit) #>     mu1[1]  sigma1[1]     mu2[1]  sigma2[1]     rho[1] #>      0.840      1.982      0.003      0.796      0.501"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"gaussian-copula-with-normal-exponential-marginals","dir":"Articles","previous_headings":"Examples","what":"Gaussian Copula with Normal + Exponential Marginals","title":"Getting Started with copulaStan","text":"","code":"seed <- 2024 set.seed(seed) true_rho <- 0.5 n <- 2000  margins <- c(\"norm\", \"exp\") params <- list(list(mean = 0.8, sd = 2), list(rate = 1)) cop <- normalCopula(param = true_rho, dim = 2) mvdc_copula <- mvdc(cop, margins = margins, paramMargins = params) data <- rMvdc(n, mvdc_copula)  fit <- fit_bivariate_copula(data,   copula = \"gaussian\", marginals = c(\"normal\", \"exponential\"),   seed = seed )  print(fit) #> -- Bivariate Copula Fit -------------------------------------------------------- #> Copula: gaussian #> Marginals: \"normal\", \"exponential\" #> Data: 2000 observations #> ---- #>   variable      mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail #> 1 mu1[1]       0.818   0.818  0.045  0.045   0.745 0.892 1.00     4000     3000 #> 2 sigma1[1]    1.987   1.987  0.031  0.031   1.936 2.038 1.00     4100     3000 #> 3 lambda2[1]   1.004   1.003  0.023  0.023   0.966 1.042 1.00     3900     2800 #> 4 rho[1]       0.497   0.497  0.018  0.018   0.468 0.527 1.00     4000     3100  coef(fit) #>     mu1[1]  sigma1[1] lambda2[1]     rho[1] #>      0.818      1.987      1.004      0.497"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"gaussian-copula-with-beta-beta-marginals","dir":"Articles","previous_headings":"Examples","what":"Gaussian Copula with Beta + Beta Marginals","title":"Getting Started with copulaStan","text":"","code":"seed <- 2024 set.seed(seed) true_rho <- 0.5 n <- 2000  margins <- c(\"beta\", \"beta\") params <- list(list(shape1 = 2, shape2 = 5), list(shape1 = 3, shape2 = 4)) cop <- normalCopula(param = true_rho, dim = 2) mvdc_copula <- mvdc(cop, margins = margins, paramMargins = params) data <- rMvdc(n, mvdc_copula)  fit <- fit_bivariate_copula(data,   copula = \"gaussian\", marginals = c(\"beta\", \"beta\"),   seed = seed )  print(fit) #> -- Bivariate Copula Fit -------------------------------------------------------- #> Copula: gaussian #> Marginals: \"beta\", \"beta\" #> Data: 2000 observations #> ---- #>   variable      mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail #> 1 alpha1[1]    2.030   2.026  0.095  0.094   1.877 2.189 1.00     3800     2900 #> 2 beta1[1]     5.065   5.054  0.260  0.258   4.643 5.500 1.00     3700     2800 #> 3 alpha2[1]    3.018   3.014  0.138  0.137   2.794 3.245 1.00     3900     3000 #> 4 beta2[1]     4.025   4.019  0.183  0.182   3.726 4.330 1.00     3800     2900 #> 5 rho[1]       0.498   0.498  0.018  0.018   0.469 0.528 1.00     4000     3100  coef(fit) #>  alpha1[1]   beta1[1]  alpha2[1]   beta2[1]     rho[1] #>      2.030      5.065      3.018      4.025      0.498"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"clayton-copula-with-normal-lognormal-marginals","dir":"Articles","previous_headings":"Examples","what":"Clayton Copula with Normal + Lognormal Marginals","title":"Getting Started with copulaStan","text":"","code":"seed <- 2024 set.seed(seed) true_theta <- 2.0 n <- 2000  margins <- c(\"norm\", \"lnorm\") params <- list(list(mean = 0.8, sd = 2), list(meanlog = 0, sdlog = 0.8)) cop <- claytonCopula(param = true_theta, dim = 2) mvdc_copula <- mvdc(cop, margins = margins, paramMargins = params) data <- rMvdc(n, mvdc_copula)  fit <- fit_bivariate_copula(data,   copula = \"clayton\", marginals = c(\"normal\", \"lognormal\"),   seed = seed )  print(fit) #> -- Bivariate Copula Fit -------------------------------------------------------- #> Copula: clayton #> Marginals: \"normal\", \"lognormal\" #> Data: 2000 observations #> ---- #>   variable              mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail #> 1 mu1[1]               0.798   0.798  0.044  0.044   0.726 0.870 1.00     3500     2600 #> 2 sigma1[1]            1.986   1.986  0.032  0.032   1.934 2.039 1.00     3400     2500 #> 3 mu2[1]               0.005   0.005  0.019  0.019  -0.025 0.036 1.00     3300     2500 #> 4 sigma2[1]            0.799   0.798  0.013  0.013   0.777 0.820 1.00     3400     2600 #> 5 theta_clayton[1]     2.015   2.010  0.105  0.104   1.847 2.192 1.00     3600     2700  coef(fit) #>          mu1[1]       sigma1[1]          mu2[1]       sigma2[1] theta_clayton[1] #>           0.798           1.986           0.005           0.799            2.015"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"joe-copula-with-normal-lognormal-marginals","dir":"Articles","previous_headings":"Examples","what":"Joe Copula with Normal + Lognormal Marginals","title":"Getting Started with copulaStan","text":"","code":"seed <- 2024 set.seed(seed) true_theta <- 2.0 n <- 2000  margins <- c(\"norm\", \"lnorm\") params <- list(list(mean = 0.8, sd = 2), list(meanlog = 0, sdlog = 0.8)) cop <- joeCopula(param = true_theta, dim = 2) mvdc_copula <- mvdc(cop, margins = margins, paramMargins = params) data <- rMvdc(n, mvdc_copula)  fit <- fit_bivariate_copula(data,   copula = \"joe\", marginals = c(\"normal\", \"lognormal\"),   seed = seed )  print(fit) #> -- Bivariate Copula Fit -------------------------------------------------------- #> Copula: joe #> Marginals: \"normal\", \"lognormal\" #> Data: 2000 observations #> ---- #>   variable          mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail #> 1 mu1[1]           0.810   0.810  0.044  0.044   0.738 0.882 1.00     3400     2500 #> 2 sigma1[1]        1.994   1.994  0.032  0.032   1.942 2.047 1.00     3500     2600 #> 3 mu2[1]          -0.002  -0.002  0.019  0.019  -0.033 0.028 1.00     3300     2500 #> 4 sigma2[1]        0.803   0.803  0.013  0.013   0.781 0.825 1.00     3400     2600 #> 5 theta_joe[1]     2.008   2.005  0.080  0.079   1.878 2.142 1.00     3600     2700  coef(fit) #>      mu1[1]   sigma1[1]      mu2[1]   sigma2[1] theta_joe[1] #>       0.810       1.994      -0.002       0.803        2.008"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"model-diagnostics","dir":"Articles","previous_headings":"","what":"Model Diagnostics","title":"Getting Started with copulaStan","text":"fitting model, check diagnostics ensure reliable results.","code":""},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"convergence-rhat-and-effective-sample-size","dir":"Articles","previous_headings":"Model Diagnostics","what":"Convergence: Rhat and Effective Sample Size","title":"Getting Started with copulaStan","text":"summary() output includes rhat, ess_bulk, ess_tail parameter, computed posterior package. Rhat 1.01 parameters. Values 1.01 suggest chains converged. ess_bulk ess_tail report effective sample size bulk tail quantities posterior. Aim least 400 effective samples per parameter.","code":"summ <- summary(fit)  # Check convergence all(summ$rhat < 1.01)  # Check effective sample sizes all(summ$ess_bulk > 400)"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"divergent-transitions","dir":"Articles","previous_headings":"Model Diagnostics","what":"Divergent Transitions","title":"Getting Started with copulaStan","text":"CmdStan reports divergent transitions sampling. see divergences, increase adapt_delta default 0.8 toward 1: divergences persist adapt_delta = 0.99, may indicate model-data mismatch (example, using Clayton copula data upper tail dependence).","code":"fit <- fit_bivariate_copula(data,   copula = \"gaussian\", marginals = c(\"normal\", \"lognormal\"),   adapt_delta = 0.95,   seed = seed )"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"model-comparison-with-loo-cv","dir":"Articles","previous_headings":"Model Diagnostics","what":"Model Comparison with LOO-CV","title":"Getting Started with copulaStan","text":"model stores pointwise log-likelihoods (log_lik) generated quantities block. Use loo package approximate leave-one-cross-validation: compare two models, fit compare loo objects: model higher expected log predictive density (ELPD) preferred.","code":"library(loo)  # Extract log-likelihood matrix: rows = iterations, columns = observations log_lik <- fit$fit$draws(\"log_lik\", format = \"matrix\") loo_result <- loo(log_lik) print(loo_result) loo_gaussian <- loo(fit_gaussian$fit$draws(\"log_lik\", format = \"matrix\")) loo_clayton <- loo(fit_clayton$fit$draws(\"log_lik\", format = \"matrix\")) loo_compare(loo_gaussian, loo_clayton)"},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"prior-specification","dir":"Articles","previous_headings":"","what":"Prior Specification","title":"Getting Started with copulaStan","text":"Stan model uses weakly informative default priors designed regularize estimation without strongly constraining posterior.","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"copula-dependence-parameter-priors","dir":"Articles","previous_headings":"Prior Specification","what":"Copula Dependence Parameter Priors","title":"Getting Started with copulaStan","text":"Custom priors currently supported R interface. use different priors, modify Stan model file directly inst/stan/fit_bivariate_copula.stan.","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"gaussian-copula-1","dir":"Articles","previous_headings":"Mathematical Details","what":"Gaussian Copula","title":"Getting Started with copulaStan","text":"Transformation uniform marginals: \\[U_1 = F_1(X_1), \\quad U_2 = F_2(X_2)\\] \\(F_1\\) \\(F_2\\) marginal CDFs. Transformation standard normal: \\[Z_1 = \\Phi^{-1}(U_1), \\quad Z_2 = \\Phi^{-1}(U_2)\\] Copula density (ratio bivariate product univariate normals): \\[c(u_1, u_2; \\rho) = \\frac{1}{\\sqrt{1-\\rho^2}} \\exp\\left( -\\frac{1}{2(1-\\rho^2)}(z_1^2 + z_2^2 - 2\\rho z_1 z_2) + \\frac{z_1^2}{2} + \\frac{z_2^2}{2} \\right)\\] Log-likelihood: \\[\\log c(u_1, u_2; \\rho) = -\\frac{1}{2} \\log(1-\\rho^2) + \\frac{\\rho z_1 z_2 - \\frac{1}{2}\\rho^2 (z_1^2 + z_2^2)}{1-\\rho^2}\\]","code":""},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"clayton-copula-1","dir":"Articles","previous_headings":"Mathematical Details","what":"Clayton Copula","title":"Getting Started with copulaStan","text":"CDF: \\[C(u, v; \\theta) = \\left(u^{-\\theta} + v^{-\\theta} - 1\\right)^{-1/\\theta}, \\quad \\theta > 0\\] Density (second mixed partial derivative): \\[c(u, v; \\theta) = (\\theta + 1) \\, u^{-\\theta - 1} \\, v^{-\\theta - 1} \\left( u^{-\\theta} + v^{-\\theta} - 1 \\right)^{-1/\\theta - 2}\\] Log-likelihood: \\[\\log c(u, v; \\theta) = \\log(1 + \\theta) + (-\\theta - 1)(\\log u + \\log v) - \\frac{2\\theta + 1}{\\theta} \\log(u^{-\\theta} + v^{-\\theta} - 1)\\]","code":""},{"path":"https://benlug.github.io/copulaStan/articles/copulaStan-intro.html","id":"joe-copula-1","dir":"Articles","previous_headings":"Mathematical Details","what":"Joe Copula","title":"Getting Started with copulaStan","text":"CDF \\(\\bar{u} = 1-u\\), \\(\\bar{v} = 1-v\\): \\[C(u, v; \\theta) = 1 - \\left[\\bar{u}^\\theta + \\bar{v}^\\theta - \\bar{u}^\\theta \\bar{v}^\\theta\\right]^{1/\\theta}, \\quad \\theta \\geq 1\\] Let \\(= \\bar{u}^\\theta\\), \\(b = \\bar{v}^\\theta\\), \\(S = + b - ab\\). Density: \\[c(u, v; \\theta) = \\theta \\, \\bar{u}^{\\theta-1} \\, \\bar{v}^{\\theta-1} \\, S^{1/\\theta - 2} \\left[ S + \\frac{\\theta - 1}{\\theta}(1 - )(1 - b) \\right]\\] Log-likelihood: \\[\\log c(u, v; \\theta) = \\log\\theta + (\\theta-1)[\\log\\bar{u} + \\log\\bar{v}] + \\left(\\frac{1}{\\theta} - 2\\right)\\log S + \\log\\left[S + \\frac{\\theta-1}{\\theta}(1-)(1-b)\\right]\\]","code":""},{"path":"https://benlug.github.io/copulaStan/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Benedikt Lugauer. Author, maintainer.","code":""},{"path":"https://benlug.github.io/copulaStan/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lugauer B (2026). copulaStan: Fit Bivariate Copula Models Using Stan. R package version 0.5.0, https://benlug.github.io/copulaStan/.","code":"@Manual{,   title = {copulaStan: Fit Bivariate Copula Models Using Stan},   author = {Benedikt Lugauer},   year = {2026},   note = {R package version 0.5.0},   url = {https://benlug.github.io/copulaStan/}, }"},{"path":"https://benlug.github.io/copulaStan/index.html","id":"copulastan-","dir":"","previous_headings":"","what":"copulaStan: Bayesian Bivariate Copula Models with Stan","title":"copulaStan: Bayesian Bivariate Copula Models with Stan","text":"copulaStan fits bivariate copula models full Bayesian inference via Stan. jointly estimates copula dependence parameter marginal distribution parameters, returning posterior draws uncertainty quantification model comparison.","code":""},{"path":"https://benlug.github.io/copulaStan/index.html","id":"why-copulastan","dir":"","previous_headings":"","what":"Why copulaStan?","title":"copulaStan: Bayesian Bivariate Copula Models with Stan","text":"Copulas separate modeling marginal distributions modeling dependence. lets choose best-fitting distribution variable independently, capture variables relate copula function – without restrictive joint distribution assumptions. copulaStan makes approach accessible R : Full Bayesian inference – posterior distributions parameters, just point estimates Flexible marginals – mix match Normal, Lognormal, Exponential, Beta distributions Multiple copula families – Gaussian, Clayton, Joe copulas different dependence structures Built-diagnostics – Rhat, ESS, pointwise log-likelihoods LOO-CV model comparison Modern Stan backend – powered CmdStan via cmdstanr fast, reliable sampling","code":""},{"path":[]},{"path":[]},{"path":"https://benlug.github.io/copulaStan/index.html","id":"marginal-distributions","dir":"","previous_headings":"Supported Models","what":"Marginal Distributions","title":"copulaStan: Bayesian Bivariate Copula Models with Stan","text":"marginal can set independently, giving 4 x 4 = 16 possible marginal combinations per copula family.","code":""},{"path":"https://benlug.github.io/copulaStan/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"copulaStan: Bayesian Bivariate Copula Models with Stan","text":"copulaStan requires CmdStan. Install first already: install copulaStan GitHub:","code":"install.packages(\"cmdstanr\", repos = c(\"https://stan-dev.r-universe.dev\", getOption(\"repos\"))) cmdstanr::install_cmdstan() # install.packages(\"devtools\") devtools::install_github(\"benlug/copulaStan\")"},{"path":"https://benlug.github.io/copulaStan/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"copulaStan: Bayesian Bivariate Copula Models with Stan","text":"Simulate data Gaussian copula normal lognormal marginals, recover parameters: Try different copula family:","code":"library(copulaStan) library(copula)  # Simulate bivariate data set.seed(123) cop <- normalCopula(param = 0.5, dim = 2) margins <- c(\"norm\", \"lnorm\") params <- list(list(mean = 0, sd = 1), list(meanlog = 0, sdlog = 0.8)) mvdc_copula <- mvdc(cop, margins = margins, paramMargins = params) data <- rMvdc(1000, mvdc_copula)  # Fit the model fit <- fit_bivariate_copula(data,   copula = \"gaussian\",   marginals = c(\"normal\", \"lognormal\"),   seed = 123 )  # Inspect results print(fit) #> -- Bivariate Copula Fit -------------------------------------------------------- #> Copula: gaussian #> Marginals: \"normal\", \"lognormal\" #> Data: 1000 observations #> ---- #>   variable      mean  median     sd    mad      q5   q95 rhat ess_bulk ess_tail #> 1 mu1[1]       0.024   0.024  0.032  0.032  -0.029 0.076 1.00     3814     2848 #> 2 sigma1[1]    1.005   1.005  0.023  0.023   0.967 1.042 1.00     3741     2751 #> 3 mu2[1]       0.014   0.014  0.026  0.027  -0.028 0.057 1.00     3710     2695 #> 4 sigma2[1]    0.812   0.811  0.019  0.019   0.781 0.844 1.00     3853     2874 #> 5 rho[1]       0.481   0.481  0.024  0.024   0.442 0.520 1.00     3918     2992  coef(fit) #>     mu1[1]  sigma1[1]     mu2[1]  sigma2[1]     rho[1] #>      0.024      1.005      0.014      0.812      0.481 # Clayton copula for lower tail dependence fit_clay <- fit_bivariate_copula(data,   copula = \"clayton\",   marginals = c(\"normal\", \"lognormal\"),   seed = 123 )  # Compare models via LOO-CV library(loo) loo_gauss <- loo(fit$fit$draws(\"log_lik\", format = \"matrix\")) loo_clay <- loo(fit_clay$fit$draws(\"log_lik\", format = \"matrix\")) loo_compare(loo_gauss, loo_clay)"},{"path":"https://benlug.github.io/copulaStan/index.html","id":"learning-more","dir":"","previous_headings":"","what":"Learning More","title":"copulaStan: Bayesian Bivariate Copula Models with Stan","text":"Get Started – comprehensive introduction examples copula families, diagnostics, prior specification. Function Reference – complete documentation exported functions methods. Changelog – version history release notes.","code":""},{"path":"https://benlug.github.io/copulaStan/index.html","id":"getting-help","dir":"","previous_headings":"","what":"Getting Help","title":"copulaStan: Bayesian Bivariate Copula Models with Stan","text":"Browse package website documentation vignettes. Report bugs request features GitHub Issues.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/coef.copula_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract point estimates from a copula_fit — coef.copula_fit","title":"Extract point estimates from a copula_fit — coef.copula_fit","text":"Returns posterior means model parameters named numeric vector. Parameter names match used Stan model (e.g., \"mu1[1]\", \"sigma1[1]\", \"rho[1]\").","code":""},{"path":"https://benlug.github.io/copulaStan/reference/coef.copula_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract point estimates from a copula_fit — coef.copula_fit","text":"","code":"# S3 method for class 'copula_fit' coef(object, ...)"},{"path":"https://benlug.github.io/copulaStan/reference/coef.copula_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract point estimates from a copula_fit — coef.copula_fit","text":"object copula_fit object. ... Additional arguments (unused).","code":""},{"path":"https://benlug.github.io/copulaStan/reference/coef.copula_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract point estimates from a copula_fit — coef.copula_fit","text":"named numeric vector posterior means, one element per model parameter.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/coef.copula_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract point estimates from a copula_fit — coef.copula_fit","text":"","code":"if (FALSE) { # \\dontrun{ fit <- fit_bivariate_copula(data,   copula = \"gaussian\",   marginals = c(\"normal\", \"lognormal\") ) coef(fit) } # }"},{"path":"https://benlug.github.io/copulaStan/reference/copula_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a copula_fit object — copula_fit","title":"Create a copula_fit object — copula_fit","text":"Create copula_fit object","code":""},{"path":"https://benlug.github.io/copulaStan/reference/copula_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a copula_fit object — copula_fit","text":"","code":"copula_fit(fit, copula, marginals, data_dim)"},{"path":"https://benlug.github.io/copulaStan/reference/copula_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a copula_fit object — copula_fit","text":"fit CmdStanMCMC fit object. copula Copula type string. marginals Character vector marginal distribution names. data_dim Dimensions input data.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/copula_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a copula_fit object — copula_fit","text":"copula_fit S3 object.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/fit_bivariate_copula.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Bivariate Copula Model — fit_bivariate_copula","title":"Fit Bivariate Copula Model — fit_bivariate_copula","text":"Fits bivariate copula model data marginal parameter estimation. Supports Gaussian, Clayton, Joe copulas normal, lognormal, exponential, beta marginal distributions. Uses CmdStan Bayesian inference via cmdstanr package.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/fit_bivariate_copula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Bivariate Copula Model — fit_bivariate_copula","text":"","code":"fit_bivariate_copula(   U,   copula,   marginals,   iter = 1000,   chains = 4,   warmup = 1000,   thin = 1,   seed = NULL,   adapt_delta = 0.8,   max_treedepth = 10,   parallel_chains = 1,   refresh = 500 )"},{"path":"https://benlug.github.io/copulaStan/reference/fit_bivariate_copula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Bivariate Copula Model — fit_bivariate_copula","text":"U numeric matrix exactly two columns containing observed data. column corresponds one variable. copula Character string specifying copula type. One \"gaussian\", \"clayton\", \"joe\". marginals character vector length 2 specifying marginal distributions. element must one \"normal\", \"lognormal\", \"exponential\", \"beta\". iter Number sampling iterations per chain (warmup). Default 1000. chains Number MCMC chains. Default 4. warmup Number warmup iterations per chain. Default 1000. thin Thinning rate. Default 1. seed Random seed reproducibility. Default NULL. adapt_delta Target acceptance rate NUTS. Default 0.8. max_treedepth Maximum tree depth NUTS. Default 10. parallel_chains Number chains run parallel. Default 1. refresh often print progress (iterations). Set 0 silent. Default 500.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/fit_bivariate_copula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Bivariate Copula Model — fit_bivariate_copula","text":"copula_fit object (S3 class) containing: fit underlying CmdStanMCMC object cmdstanr, providing access raw draws, diagnostics, Stan model. copula Character string copula type used (e.g., \"gaussian\"). marginals Character vector length 2 marginal distribution names (e.g., c(\"normal\", \"lognormal\")). data_dim Integer vector length 2 giving dimensions input data (rows, columns).","code":""},{"path":"https://benlug.github.io/copulaStan/reference/fit_bivariate_copula.html","id":"supported-models","dir":"Reference","previous_headings":"","what":"Supported Models","title":"Fit Bivariate Copula Model — fit_bivariate_copula","text":"Copula types: \"gaussian\" Gaussian (normal) copula correlation parameter rho (-1, 1). \"clayton\" Clayton copula dependence parameter theta_clayton > 0. Captures lower-tail dependence. \"joe\" Joe copula dependence parameter theta_joe >= 1. Captures upper-tail dependence. Marginal distributions: \"normal\" Normal distribution parameters mu (location) sigma (scale > 0). \"lognormal\" Log-normal distribution parameters mu (log-location) sigma (log-scale > 0). Data must positive. \"exponential\" Exponential distribution rate parameter lambda > 0. Data must positive. \"beta\" Beta distribution shape parameters alpha > 0 beta > 0. Data must (0, 1).","code":""},{"path":"https://benlug.github.io/copulaStan/reference/fit_bivariate_copula.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Fit Bivariate Copula Model — fit_bivariate_copula","text":"Stan model uses following weakly informative priors: Normal / Log-normal marginals mu ~ normal(0, 5), sigma ~ lognormal(0, 1) (median = 1). Exponential marginals lambda ~ lognormal(0, 1) (median = 1). Beta marginals alpha ~ gamma(2, 0.5), beta ~ gamma(2, 0.5). Gaussian copula rho ~ uniform(-1, 1). Clayton copula theta_clayton ~ lognormal(0, 1) (median = 1). Joe copula theta_joe ~ lognormal(log(2), 0.5) (median = 2, lower-bounded 1).","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/reference/fit_bivariate_copula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Bivariate Copula Model — fit_bivariate_copula","text":"","code":"if (FALSE) { # \\dontrun{ library(copula) library(copulaStan)  set.seed(2024) n <- 1000 cop <- normalCopula(param = 0.5, dim = 2) margins <- c(\"norm\", \"lnorm\") params <- list(   list(mean = 0.8, sd = 2),   list(meanlog = 0, sdlog = 0.8) ) mvdc_copula <- mvdc(cop, margins = margins, paramMargins = params) data <- rMvdc(n, mvdc_copula)  fit <- fit_bivariate_copula(data,   copula = \"gaussian\",   marginals = c(\"normal\", \"lognormal\"),   seed = 2024 ) print(fit) summary(fit) coef(fit) } # }"},{"path":"https://benlug.github.io/copulaStan/reference/get_stan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the compiled Stan model (compiles on first use, caches for reuse) — get_stan_model","title":"Get the compiled Stan model (compiles on first use, caches for reuse) — get_stan_model","text":"Get compiled Stan model (compiles first use, caches reuse)","code":""},{"path":"https://benlug.github.io/copulaStan/reference/get_stan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the compiled Stan model (compiles on first use, caches for reuse) — get_stan_model","text":"","code":"get_stan_model()"},{"path":"https://benlug.github.io/copulaStan/reference/print.copula_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a copula_fit object — print.copula_fit","title":"Print a copula_fit object — print.copula_fit","text":"Displays summary fitted copula model including copula type, marginal distributions, sample size, parameter summary table.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/print.copula_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a copula_fit object — print.copula_fit","text":"","code":"# S3 method for class 'copula_fit' print(x, ...)"},{"path":"https://benlug.github.io/copulaStan/reference/print.copula_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a copula_fit object — print.copula_fit","text":"x copula_fit object. ... Additional arguments (unused).","code":""},{"path":"https://benlug.github.io/copulaStan/reference/print.copula_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print a copula_fit object — print.copula_fit","text":"Invisibly returns copula_fit object x, allowing usage pipelines.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/print.copula_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print a copula_fit object — print.copula_fit","text":"","code":"if (FALSE) { # \\dontrun{ fit <- fit_bivariate_copula(data,   copula = \"gaussian\",   marginals = c(\"normal\", \"lognormal\") ) print(fit) } # }"},{"path":"https://benlug.github.io/copulaStan/reference/summary.copula_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize a copula_fit object — summary.copula_fit","title":"Summarize a copula_fit object — summary.copula_fit","text":"Returns tibble posterior summaries model parameters, including mean, median, standard deviation, MAD, quantiles, convergence diagnostics (Rhat, ESS).","code":""},{"path":"https://benlug.github.io/copulaStan/reference/summary.copula_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize a copula_fit object — summary.copula_fit","text":"","code":"# S3 method for class 'copula_fit' summary(object, ...)"},{"path":"https://benlug.github.io/copulaStan/reference/summary.copula_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize a copula_fit object — summary.copula_fit","text":"object copula_fit object. ... Additional arguments (unused).","code":""},{"path":"https://benlug.github.io/copulaStan/reference/summary.copula_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize a copula_fit object — summary.copula_fit","text":"tibble posterior::summarise_draws() one row per parameter columns summary statistics diagnostics.","code":""},{"path":"https://benlug.github.io/copulaStan/reference/summary.copula_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize a copula_fit object — summary.copula_fit","text":"","code":"if (FALSE) { # \\dontrun{ fit <- fit_bivariate_copula(data,   copula = \"gaussian\",   marginals = c(\"normal\", \"lognormal\") ) summary(fit) } # }"},{"path":[]},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"breaking-changes-0-5-0","dir":"Changelog","previous_headings":"","what":"Breaking Changes","title":"copulaStan 0.5.0","text":"Migrated rstan cmdstanr Stan model compilation sampling. requires cmdstanr CmdStan installed. return type fit_bivariate_copula() now copula_fit S3 object (previously returned raw stanfit S4 object). cores argument replaced parallel_chains. control argument replaced direct adapt_delta max_treedepth arguments. Copula parameters now named rho[1], theta_clayton[1], theta_joe[1] (previously rho[1] theta[1]). Joe copula parameter theta_joe now lower bound 1 (correct constraint per Joe copula definition).","code":""},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"bug-fixes-0-5-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"copulaStan 0.5.0","text":"Fixed incorrect Joe copula density formula. previous implementation match standard derivation Joe copula CDF. Results previous Joe copula fits invalid. Added CDF clamping prevent numerical issues (NaN/Inf) marginal CDF values exactly 0 1 sampling. Fixed minor bug Gaussian copula log-likelihood square(rho) computed twice instead reusing rho_sq. Removed global side effect options(mc.cores = cores).","code":""},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"new-features-0-5-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"copulaStan 0.5.0","text":"copula_fit S3 class print(), summary(), coef() methods clean output easy parameter extraction. Comprehensive input validation informative error messages via cli. generated quantities block pointwise log_lik LOO-CV support. refresh argument control sampling progress output.","code":""},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"improvements-0-5-0","dir":"Changelog","previous_headings":"","what":"Improvements","title":"copulaStan 0.5.0","text":"Updated Stan models modern array[] syntax. Replaced heavy-tailed Cauchy priors appropriate defaults: Lognormal scale parameters, Gamma Beta shape parameters. Removed unused Stan functions legacy Stan files (fit_clayton_copula.stan, fit_joe_copula.stan). Added R CMD check GitHub Actions workflow. Expanded test suite: input validation, parameter recovery, S3 class tests.","code":""},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"dependencies-0-5-0","dir":"Changelog","previous_headings":"","what":"Dependencies","title":"copulaStan 0.5.0","text":"Added: cmdstanr, posterior, cli Removed: rstan, BH, RcppEigen","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"new-features-0-4-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"copulaStan 0.4.0","text":"Added support Exponential Beta marginal distributions fit_bivariate_copula(). Now supports: normal, lognormal, exponential, beta.","code":""},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"bug-fixes-0-4-0","dir":"Changelog","previous_headings":"","what":"Bug Fixes","title":"copulaStan 0.4.0","text":"Fixed minor bugs related marginal distribution handling.","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"improvements-0-3-1","dir":"Changelog","previous_headings":"","what":"Improvements","title":"copulaStan 0.3.1","text":"Unified copula functions single fit_bivariate_copula() entry point.","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"new-features-0-3-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"copulaStan 0.3.0","text":"Added fit_gaussian_copula() bivariate Gaussian copula models marginal parameter estimation. Supports normal lognormal marginals. Included introductory vignette.","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"new-features-0-2-0","dir":"Changelog","previous_headings":"","what":"New Features","title":"copulaStan 0.2.0","text":"Added functions fit Clayton copula models. Improved documentation.","code":""},{"path":[]},{"path":"https://benlug.github.io/copulaStan/news/index.html","id":"initial-release-0-1-0","dir":"Changelog","previous_headings":"","what":"Initial Release","title":"copulaStan 0.1.0","text":"Basic functionality fit bivariate Gaussian copula models. Initial documentation examples.","code":""}]
