<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Bivariate Copula Model — fit_bivariate_copula • copulaStan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Bivariate Copula Model — fit_bivariate_copula"><meta name="description" content="Fits a bivariate copula model to data with marginal parameter estimation.
Supports Gaussian, Clayton, and Joe copulas with normal, lognormal,
exponential, or beta marginal distributions. Uses CmdStan for Bayesian
inference via the cmdstanr package."><meta property="og:description" content="Fits a bivariate copula model to data with marginal parameter estimation.
Supports Gaussian, Clayton, and Joe copulas with normal, lognormal,
exponential, or beta marginal distributions. Uses CmdStan for Bayesian
inference via the cmdstanr package."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">copulaStan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/copulaStan-intro.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/benlug/copulaStan" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit Bivariate Copula Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/benlug/copulaStan/blob/main/R/fit_bivariate_copula.R" class="external-link"><code>R/fit_bivariate_copula.R</code></a></small>
      <div class="d-none name"><code>fit_bivariate_copula.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a bivariate copula model to data with marginal parameter estimation.
Supports Gaussian, Clayton, and Joe copulas with normal, lognormal,
exponential, or beta marginal distributions. Uses CmdStan for Bayesian
inference via the <code>cmdstanr</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_bivariate_copula</span><span class="op">(</span></span>
<span>  <span class="va">U</span>,</span>
<span>  <span class="va">copula</span>,</span>
<span>  <span class="va">marginals</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  max_treedepth <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  parallel_chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-u">U<a class="anchor" aria-label="anchor" href="#arg-u"></a></dt>
<dd><p>A numeric matrix with exactly two columns containing the observed
data. Each column corresponds to one variable.</p></dd>


<dt id="arg-copula">copula<a class="anchor" aria-label="anchor" href="#arg-copula"></a></dt>
<dd><p>Character string specifying the copula type. One of
<code>"gaussian"</code>, <code>"clayton"</code>, or <code>"joe"</code>.</p></dd>


<dt id="arg-marginals">marginals<a class="anchor" aria-label="anchor" href="#arg-marginals"></a></dt>
<dd><p>A character vector of length 2 specifying the marginal
distributions. Each element must be one of <code>"normal"</code>, <code>"lognormal"</code>,
<code>"exponential"</code>, or <code>"beta"</code>.</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Number of sampling iterations per chain (after warmup).
Default is 1000.</p></dd>


<dt id="arg-chains">chains<a class="anchor" aria-label="anchor" href="#arg-chains"></a></dt>
<dd><p>Number of MCMC chains. Default is 4.</p></dd>


<dt id="arg-warmup">warmup<a class="anchor" aria-label="anchor" href="#arg-warmup"></a></dt>
<dd><p>Number of warmup iterations per chain. Default is 1000.</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>Thinning rate. Default is 1.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Random seed for reproducibility. Default is <code>NULL</code>.</p></dd>


<dt id="arg-adapt-delta">adapt_delta<a class="anchor" aria-label="anchor" href="#arg-adapt-delta"></a></dt>
<dd><p>Target acceptance rate for NUTS. Default is 0.8.</p></dd>


<dt id="arg-max-treedepth">max_treedepth<a class="anchor" aria-label="anchor" href="#arg-max-treedepth"></a></dt>
<dd><p>Maximum tree depth for NUTS. Default is 10.</p></dd>


<dt id="arg-parallel-chains">parallel_chains<a class="anchor" aria-label="anchor" href="#arg-parallel-chains"></a></dt>
<dd><p>Number of chains to run in parallel. Default is 1.</p></dd>


<dt id="arg-refresh">refresh<a class="anchor" aria-label="anchor" href="#arg-refresh"></a></dt>
<dd><p>How often to print progress (in iterations). Set to 0 for
silent. Default is 500.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>copula_fit</code> object (S3 class) containing:</p><dl><dt><code>fit</code></dt>
<dd><p>The underlying <code>CmdStanMCMC</code> object from <code>cmdstanr</code>,
providing access to raw draws, diagnostics, and the Stan model.</p></dd>

<dt><code>copula</code></dt>
<dd><p>Character string of the copula type used
(e.g., <code>"gaussian"</code>).</p></dd>

<dt><code>marginals</code></dt>
<dd><p>Character vector of length 2 with the marginal
distribution names (e.g., <code>c("normal", "lognormal")</code>).</p></dd>

<dt><code>data_dim</code></dt>
<dd><p>Integer vector of length 2 giving the dimensions
of the input data (rows, columns).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="supported-models">Supported Models<a class="anchor" aria-label="anchor" href="#supported-models"></a></h2>


<p><strong>Copula types:</strong></p><dl><dt><code>"gaussian"</code></dt>
<dd><p>Gaussian (normal) copula with correlation
parameter <code>rho</code> in (-1, 1).</p></dd>

<dt><code>"clayton"</code></dt>
<dd><p>Clayton copula with dependence parameter
<code>theta_clayton</code> &gt; 0. Captures lower-tail dependence.</p></dd>

<dt><code>"joe"</code></dt>
<dd><p>Joe copula with dependence parameter
<code>theta_joe</code> &gt;= 1. Captures upper-tail dependence.</p></dd>


</dl><p><strong>Marginal distributions:</strong></p><dl><dt><code>"normal"</code></dt>
<dd><p>Normal distribution with parameters <code>mu</code>
(location) and <code>sigma</code> (scale &gt; 0).</p></dd>

<dt><code>"lognormal"</code></dt>
<dd><p>Log-normal distribution with parameters <code>mu</code>
(log-location) and <code>sigma</code> (log-scale &gt; 0). Data must be
positive.</p></dd>

<dt><code>"exponential"</code></dt>
<dd><p>Exponential distribution with rate parameter
<code>lambda</code> &gt; 0. Data must be positive.</p></dd>

<dt><code>"beta"</code></dt>
<dd><p>Beta distribution with shape parameters <code>alpha</code> &gt; 0
and <code>beta</code> &gt; 0. Data must be in (0, 1).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a></h2>


<p>The Stan model uses the following weakly informative priors:</p><dl><dt>Normal / Log-normal marginals</dt>
<dd><p><code>mu ~ normal(0, 5)</code>,
<code>sigma ~ lognormal(0, 1)</code> (median = 1).</p></dd>

<dt>Exponential marginals</dt>
<dd><p><code>lambda ~ lognormal(0, 1)</code>
(median = 1).</p></dd>

<dt>Beta marginals</dt>
<dd><p><code>alpha ~ gamma(2, 0.5)</code>,
<code>beta ~ gamma(2, 0.5)</code>.</p></dd>

<dt>Gaussian copula</dt>
<dd><p><code>rho ~ uniform(-1, 1)</code>.</p></dd>

<dt>Clayton copula</dt>
<dd><p><code>theta_clayton ~ lognormal(0, 1)</code>
(median = 1).</p></dd>

<dt>Joe copula</dt>
<dd><p><code>theta_joe ~ lognormal(log(2), 0.5)</code>
(median = 2, lower-bounded at 1).</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="print.copula_fit.html">print.copula_fit()</a></code>, <code><a href="summary.copula_fit.html">summary.copula_fit()</a></code>,
<code><a href="coef.copula_fit.html">coef.copula_fit()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://copula.r-forge.r-project.org/" class="external-link">copula</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://benlug.github.io/copulaStan/">copulaStan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">cop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/ellipCopula.html" class="external-link">normalCopula</a></span><span class="op">(</span>param <span class="op">=</span> <span class="fl">0.5</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">margins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"lnorm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.8</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanlog <span class="op">=</span> <span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mvdc_copula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">mvdc</a></span><span class="op">(</span><span class="va">cop</span>, margins <span class="op">=</span> <span class="va">margins</span>, paramMargins <span class="op">=</span> <span class="va">params</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Mvdc.html" class="external-link">rMvdc</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mvdc_copula</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fit_bivariate_copula</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  copula <span class="op">=</span> <span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>  marginals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"lognormal"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">2024</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benedikt Lugauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

